\documentclass[11pt,a4paper,ngerman]{article}
 \usepackage[utf8]{inputenc} %UTF8 input file
\usepackage[T1]{fontenc} 
\usepackage[ngerman]{babel} %Umlaute,Silbentrennung 
%\usepackage{textcomp} % Zusatzpaket textcomp - damit werden einige Sonderzeichen, insbesondere das Euro-Symbolaktiviert. Änderungen siehe Beispieltext.
\usepackage{hyperref} %URLs können eingefügt werden
\usepackage{booktabs} %Tabellen 
\usepackage{pdflscape} % Paket lscape (oder für pdflatex das Paket pdflscape)
\usepackage{cite} %zum verwenden von BibTex
\date{\today}
\author{Christof Pfannenmüller}
\title{DIY: Pflichtenheft Wordclock}
\begin{document}
\maketitle 
\tableofcontents 
\newpage
\section{Über dieses Dokument}
Um die Entwicklung meiner Wordclock etwas zu ordnen möchte in diesem Dokument das Erstellen und die Aufgaben dabei etwas sortiert aufführen. Das gesamte Projekt wurde auf Github\cite{githubWC} und im Wiki der Vorlesung DIY: Personal Fabrication\cite{wikiWC}  dokumentiert und 
\section{Lastenheft}
{\large Hier habe ich das bereits erstellte Lastenheft eingefügt.  }\\
Lastenheft Wordclock:\\
\\ 
Weckfunktion: vorsehen einer Weckfunktion mit Ton und Snoozefunktion\\
\\
Taster zum Ausschalten der Alarmfunktion, Snozze und zum Einstellen der Uhrzeit\\
\\
Helligkeitsanpassung: über Sensor oder über Software und Schalter an der Rückseite\\
\\
Sekundenanzeige\\
\\
Datum und Wochentag anzeigen\\ 
\\
Funkanbindung zum automatischen Uhrzeit einstellen\\
\\
Stromreserve: Uhrzeit bleibt bestehen bei Stromausfall  evtl. auch Anzeige und Weckfunktion ohne Strom\\ 
\\
Ausschalter: kleinen Ausschalter an der Unterseite zum gänzlichen Ausschalten (Uhrzeit läuft über Batterie weiter\\
\\
USB Versorgung\\
\\
24h Modus: Wecker klingelt nur alle 24h nicht alle 12 und die Weckfunktion kann somit angelassene werden\\
\\
verschiedene Frontcovers möglich: in verschiedenen Sprachen, dafür verschiedene Möglichkeiten der LED Ansteuerung\\
\\
Stabiles Gehäuse, schön klein\\
\\
Standfuß (standsicher)\\
Weiter Ideen für später: \par
Beschriftung auf der Rückseite, evtl  noch Schriftzug Wordclock oder CC Zeichen (oder beides)

\begin{landscape}
\section{Pflichtenheft}
\begin{tabular}[]{p{2cm}p{2cm}p{10cm}p{2cm}p{2cm}}
	\toprule
	Aufgabe & Beschreibung & Wie umzusetzen  & bis & Status \\
	\midrule
	Weckfunktion & & Lautsprecher/Tongeber, Taster für Snoozefunktion & & \\
	Weckzeitpunkt einstellen & & mehrere Taster, mind. 2 (Mode, Up) besser 3 (Mode, Up, Down); Mode kurz drücken zeigt aktuellen Weckzeitpunkt an, lange drücken um in Modus Weckzeitpunkt kommen; Unterscheidungsmöglichkeit AM/PM notwendig \\
	Uhrzeit einstellen & & Taster Up (Down) von Weckzeitpunkt verwenden; eigenen Taster um in Modus Uhrzeit einstellen zu kommen, oder mehrere Taster gleichzeitig drücken; wen gewünscht Möglichkeit für Datum einstellen (daraus Wochentag berechnen) \\
	Anpassung der Helligkeit & Anzeige heller bei heller Umgebung & Sensor für Umgebungslicht mit passender Elektronik; Loch in Gehäuse; Regelung der LEDs durch PWM (kompliziert) evtl. Controller oder durch IC (dafür ADU notwendig) \\
	Sekunden-Anzeige & zeigt Sekunden auf der Matrix an & Knopf durch den in Sekundenmodus gewechselt wird; Anzeige der Sekunden auf der Matrix, evtl. nicht bei jedem Frontcover möglich (muss deaktiviert werden können); wo Sekunden gespeichert? \\
	Anzeige Datum und Wochentag & & Wie anzeigen? Wo gespeichert? evtl. nicht bei jedem Frontcover möglich (muss deaktiviert werden können) \\
	Funkuhr & Einstellen der Uhrzeit nach Atomuhr & DCF77 Verbindung um Uhrzeit automatisch zu finden und einzustellen.\\
	Stromreserve & & Uhrzeit bleibt erhalten und Wecker klingelt trotz fehlendem Strom; Anzeige trotzdem aktiv würde Speicherdauer verkürzen ( Anzeige nur im Moment des Weckens oder gar nicht)\\
\end{tabular}
	%Seitenumbruch in Tabelle (besser lösen?)
	\newpage
	\begin{tabular}[]{p{2cm}p{2cm}p{10cm}p{2cm}p{2cm}}
	\toprule
	Aufgabe & Beschreibung & Wie umzusetzen  & bis & Status \\
	\midrule
	Uhr komplett ausschalten && Uhr über kleinen Schalter komplett ausschalten; Taster an Unterseite oder hinter Frontcover verstecken (bleibt Uhrzeit und Einstellungen erhalten?)\\
	Stromversorgung && Uhr wird über USB-Netzteil versorgt; USB Buchse verbauen \\
	24h Modus && Wecker klingelt nur um 6:00am, Uhr zeigt aber gleiches an für am/pm\\
	verschiedene Frontcovers & & Frontcover auswechselbar; verschiedene Farben möglich (evtl. bei Farben aktuelle Uhrzeit unterschiedlich gut erkennbar); verschiedene Sprachen (Umschalten der Matrix auf andere Sprache muss möglich sein, dafür Taster etc.)\\
	Stabiles Gehäuse & & Gehäuse mit sicherem Stand; stabil um nicht kaputt zu gehen (herunterfallen); vorerst aus Holz später Alu etc (aus einem Teil)\\
	Programmieren der Uhr && Schnittstelle um Uhr auch später noch programmieren zu können; an Unterseite oder hinter Frontplatte verstecken\\
	LED Helligkeit && LEDs passen Helligkeit an Umgebungslicht an; LEDs nachts austom. aus (24h Zeiteingabe (8-20Uhr: hell, 20-8Uhr: dunkel))

\end{tabular}
\end{landscape}

\section{Umsetzung}
	Der Aufbau der Wordclock soll von vorne nach hinten und von außen nach innen erfolgen:\\
	Ich möchte zuerst die Größe der Frontplatte festlegen, dann ein entsprechendes CAD Modell erstellen und die Schaltung intern auf einer einzelnen Platine unterbringen, da dies den Verdrahtungsaufwand verringert. Das Gehäuse möchte ich zuerst nur aus Holz bauen bzw. am 3D-Drucker ausdrucken und dies aber so, dass es möglich ist zu späteren Zeitpunkten ein Gehäuse aus Aluminium oder Holz zu fräsen. \par
	Ich möchte nicht nur selbstgestaltete Frontplatten verwenden können, sonder auch solche des Herstellers qlocktwo. Dadurch bin ich zwar an die genaue Größe der Frontplatte gebunden, kann aber auf die vielen verschiedenen Sprachen und Farben des Herstellers zugreifen. \par

\subsection{Frontplatte}
Für die Frontplatte möchte ich mehrere Sprachen machen, auf jeden Fall Deutsch und Englisch so wie nach Möglichkeit ein Dialekt (vorzugsweise Fränkisch)\\
Auflistung aller Sprachen TODO!!
Im Internet habe ich eine gute Lösung zu Befestigung gefunden: Die Frontplatte ist mit vier Magneten beklebt und  wird von vier weiteren Magneten an der Zwischenplatte gehalten und kann also ausgetauscht werden. Verbesserung: nur vier Magneten an Zwischenplatte, dafür Metall an Frontplatte
\subsection{Gehäuse}
stabil
Frontmaße identisch mit der der Frontplatte, Tiefe möglichst gering 
Möglichkeit Platine, Zwischenplatte und Frontplatte zu befestigen
Anschluss für USB und Löcher für Taster
\subsection{Zwischenplatte}
Die Zwischenplatte dient dazu, dass jede LED nur das für sie vorgesehene Zeichen auf der Frontplatte erleuchtet. Auch muss die Frontplatte durch die Zwischenplatte gehalten werden. Dafür möchte ich, wie in den meisten Wordclock-Ideen Magnete verwenden, da somit ein leichtes Auswechseln der Frontplatte möglich ist. Auch eine Verbindung zum Gehäuse muss durch die Frontplatte realisiert werden. Da die gesamte Schaltung nach Möglichkeit auf einer Platine realisiert werden soll werden wohl auch andere Bauelemente außer den LEDs auf der Vorderseite platziert werden müssen. Dafür ist es notwendig Aussparungen vorzusehen.  
Da es bei manchen Frontplatten Zeichen gibt, die größer sind und somit von mehreren LEDs angeleuchtet werden sollten, sollten die Zwischenstege der einzelnen LEDs möglichst dünn sein, um nicht einen Schatten zu werfen. Sie dürfen aber auch nicht zu dünn und somit evtl. durchscheinend sein. Möglichkeit: Kegelförmig zulaufend, ähnlich dem Abstrahlkegel der LEDs (wie zu Drucken/herzustellen)
Die Dicke der Zwischenplatte ergibt sich aus dem Abstrahlwinkel der LEDs, dieser ist bei fasst allen LEDs die für mich in Frage kamen 120 Grad Für die Dicke der Zwischenplatte ergibt sich damit: $d = \frac{0,5 * Buchstabendurchmesser}{tan60^\circ } $ 
\subsection{Platine}
\subsubsection{LEDs}
Ich möchte keine farbige Wordclock und benötige deshalb keine RGB-LEDs. \\
\begin{itemize}
\item klein
\item weiß (neutralweiß) 
\item hell
\item Abstrahlwinkel möglichst groß, damit Platine näher an Frontplatte kann insg. Uhr dünner wird
\item kostengünstig
\item möglichst geringer Stromverbrauch
\end{itemize}
Eierlegende Wollmilchsau, also Kompromiss finden\\
Suche im Reichelt-Katalog
%Beziehungen Lichtstrom lichtfarbe abstahlwinkel  -------------------------------------------
Eine weitere Möglichkeit für die LEDs sind adressierbare LEDs, so wurde eine Steuerung über Schieberegister entfallen (Tipp von Jürgen)
\subsubsection{LED-Verdrahtung}
Für die LEDs stellt sich die Frage nach einer Matrix- oder Einzelansteuerung. Die folgende Tabelle soll die Vor- und Nachteile der beiden Methoden darstellen:\\
\begin{tabular}[]{p{3cm}p{3cm}p{3cm}p{3cm}}
	\toprule
	Vorteile Matrix & Nachteile Matrix & Vorteile Einzelansteuerung  & Nachteile Einzelansteuerung\\
	\midrule
	stromsparend & immer nur eine LED an; nicht so hell & Alle LEDs an; hell & Stromverbrauch größer\\
	&Controller muss öfter aufwachen & lange Sleepzeiten des IC\\
	Dimmen über IC gleich integrierbar & Dimmen über abändern der Zeiträume die einzelne LED leuchtet & gemeinsammes Dimmen über Anode/Kathode aller LEDs & LEDs nicht unterschiedlich dimmbar
\end{tabular}
Der Verdrahtungsaufwand der beiden Methoden ist nahezu identisch, da ich die Schaltung auf einer einzige Platine unterbringen will.\\
Beim betrachten der Ansteuerzeiten für eine Einzelansteuerung fällt mir auf:\\
Gesamtzeit für einen Durchlauf aller LEDs muss kleiner als $1\over30$ einer Sekunde sein (damit kein Flackern sichtbar; vgl. Film). Also Zeit für eine LED bei 100\% Helligkeit: $\frac{1}{10*11*30} = \frac{1}{3300}=0,303ms$.Jetzt würde sich die Zeit durch Dimmen noch weiter verkürzen, was sehr kompliziert würde. Deswegen ist eine Einzelansteuerung und Dimmen aller LEDs über verbundene Anode/Kathode meine Meinung nach einfacher.\\
Ansteuern der LEDs über Schieberegister (kaskadierbar, benötigt also nur wenige Anschlüsse des IC) oder über LED-Treiber (eingebaute Möglischkeit des Dimmens; unabhänig von einander dimmbar; Ansteuerung über I2C)

\subsubsection{Ansteuerung}
Nach Möglichkeit SMD Bauteile verwenden, damit die Ansteuerung gut auf der Platine unterzubringen ist, trotzdem groß genug, damit es gut lötbar ist. So klein wie möglich so groß wie nötig.
\paragraph{Uhrzeit}

Viele Wordclocks verwenden ein RTC (Real Time Clock), beim Suchen habe ich eine gefunden, welche die Möglichkeit hat einen Alarm als Interrupt auszugeben(\url{http://www.reichelt.de/Real-Time-Clock/DS-1337/3/index.html?ACTION=3&GROUPID=2949&ARTICLE=58151&OFFSET=500&WKID=0&}), somit kann der Mikrocontroller die ganze Zeit im Schlafmodus sein und spart Strom. Zu Beginn kann man auch eine if-Abfrage verwenden, jedes mal, wenn die Uhrzeit geändert wird ob nun ein Alarm ausgegeben werden muss. Möglicherweise muss auch das Umschalten der LEDs immer auf einen Interrupt der RTC geschehen (wie weiß der Mikrocontroller sonst, dass eine Minute vorbei ist?)


\paragraph{Dimmen}
Helligkeit über PWM Controller anpassen wie?
LDR für Helligkeitsanpassung? evtl. kombinieren in gemeinsamer Ansteuerung, sodass IC auf volle Leistung aussteuern kann
Da sehr aufwändig und
\paragraph{Taster und Schalter}

wie schalter für Snozze und einstellen verbauen etc

Idee: alle Taster an Rückseite gehen auf einen interruptanschluss und jeder zusätzlivch auf einen anderen Digitalanschluss, damit Interrupspins sparen; muss über Optokopler ??
\subsubsection{Stromversorgung}
USB evtl. Lightningstecker als Anschluss       
Handyakku?USB Puffern\cite{RTCDatenblatt}


\bibliography{Wordclock-Bibliographie} %hier steht der Name der Bib-Datei
\bibliographystyle{acm}  %Citationsstil "ieeetran" geht nicht; warum?

\end{document}